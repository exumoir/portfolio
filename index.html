<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORE.IX | OMNIPOTENCE DIGITALE</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@700&family=Space+Grotesk:wght@300;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --neon: #00f2ff;
            --magenta: #ff0077;
            --dark: #000000;
        }

        body {
            margin: 0; background: var(--dark); color: white;
            font-family: 'Space Grotesk', sans-serif; overflow: hidden;
            user-select: none;
        }

        #webgl-canvas { position: fixed; top: 0; left: 0; outline: none; z-index: 1; }

        /* UI OVERLAY */
        #interface {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; pointer-events: none;
        }

        .nav-link {
            pointer-events: auto; color: white !important; font-family: 'Syncopate';
            font-size: 0.8rem; letter-spacing: 2px; transition: 0.3s;
        }
        .nav-link:hover { color: var(--neon) !important; text-shadow: 0 0 15px var(--neon); }

        .section-content {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 80%; max-width: 800px; opacity: 0; transition: 1s;
            pointer-events: none; text-align: center;
        }
        .section-content.visible { opacity: 1; pointer-events: auto; }

        .glitch-title {
            font-family: 'Syncopate'; font-size: 8vw; font-weight: 700;
            text-transform: uppercase; line-height: 0.8;
            background: linear-gradient(45deg, #fff, var(--neon));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* BTN START */
        #init-btn {
            position: fixed; bottom: 50px; left: 50%; transform: translateX(-50%);
            padding: 15px 40px; border: 1px solid var(--neon);
            background: rgba(0,242,255,0.1); color: var(--neon);
            font-family: 'Syncopate'; cursor: pointer; z-index: 100;
            pointer-events: auto; transition: 0.5s;
        }
        #init-btn:hover { background: var(--neon); color: black; box-shadow: 0 0 30px var(--neon); }
    </style>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
                "gsap": "https://cdn.skypack.dev/gsap"
            }
        }
    </script>
</head>
<body>

    <button id="init-btn">INITIALISER LE SYSTÈME</button>
    <canvas id="webgl-canvas"></canvas>

    <div id="interface">
        <nav class="navbar navbar-expand px-4 py-3">
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="#" onclick="moveCam(0, 30, 0, 'lab')">LAB</a>
                <a class="nav-link" href="#" onclick="moveCam(20, 0, 20, 'data')">DATA</a>
                <a class="nav-link" href="#" onclick="moveCam(-20, -10, 10, 'comm')">COMM</a>
            </div>
        </nav>

        <div id="hero" class="section-content visible">
            <h1 class="glitch-title">CORE.IX</h1>
            <p class="text-uppercase tracking-widest text-info mt-3">Architecte de Réalités Digitales</p>
        </div>

        <div id="lab" class="section-content">
            <h2 class="display-3 fw-bold">PROJETS_01</h2>
            <p class="lead text-white-50">Exploration volumétrique et shaders avancés.</p>
        </div>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import gsap from 'gsap';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        let scene, camera, renderer, composer, grid;
        const mouse = new THREE.Vector2();
        
        // --- INITIALISATION ---
        function init() {
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.02);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
            camera.position.z = 50;

            renderer = new THREE.WebGLRenderer({ canvas: document.querySelector('#webgl-canvas'), antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            // POST-PROCESSING
            composer = new EffectComposer(renderer);
            composer.addPass(new RenderPass(scene, camera));
            const bloom = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
            composer.addPass(bloom);

            createGrid();
            animate();
        }

        // --- LA MATRICE (GRID) ---
        function createGrid() {
            const size = 100;
            const divisions = 40;
            const geometry = new THREE.BoxGeometry(0.5, 0.5, 0.5);
            const material = new THREE.MeshBasicMaterial({ color: 0x00f2ff, transparent: true, opacity: 0.5 });
            
            grid = new THREE.InstancedMesh(geometry, material, divisions * divisions);
            const dummy = new THREE.Object3D();
            let i = 0;
            for(let x = 0; x < divisions; x++) {
                for(let y = 0; y < divisions; y++) {
                    dummy.position.set((x - divisions/2) * 4, (y - divisions/2) * 4, 0);
                    dummy.updateMatrix();
                    grid.setMatrixAt(i++, dummy.matrix);
                }
            }
            scene.add(grid);
        }

        // --- NAVIGATION SPATIALE ---
        window.moveCam = (x, y, z, sectionId) => {
            gsap.to(camera.position, { x, y, z: z + 30, duration: 2.5, ease: "expo.inOut" });
            
            document.querySelectorAll('.section-content').forEach(s => s.classList.remove('visible'));
            document.getElementById(sectionId).classList.add('visible');
        };

        // --- AUDIO ENGINE ---
        const initBtn = document.querySelector('#init-btn');
        initBtn.onclick = () => {
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(50, audioCtx.currentTime); 
            gainNode.gain.setValueAtTime(0.05, audioCtx.currentTime);
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            
            gsap.to(initBtn, { opacity: 0, pointerEvents: 'none' });
            init();
        };

        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.001;
            
            // Faire "respirer" la grille
            grid.rotation.z = Math.sin(time * 0.1) * 0.1;
            grid.rotation.y = Math.cos(time * 0.1) * 0.1;

            composer.render();
        }

        window.addEventListener('mousemove', (e) => {
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            
            gsap.to(camera.rotation, { 
                y: -mouse.x * 0.1, 
                x: mouse.y * 0.1, 
                duration: 1 
            });
        });

    </script>
</body>
</html>
